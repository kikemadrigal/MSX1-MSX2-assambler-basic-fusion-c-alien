710definta-z
720defusr=&h003B:a=usr(0):defusr1=&h003E:a=usr1(0):defusr2=&H90:a=usr2(0)
725defusr3=&H41:defusr4=&H44
730goto14000
800gosub6500
810gosub13000:gosub13100
830gosub10200
840gosub11000
850gosub12000
860gosub13800
820strig(0)on:onstriggosub10500
580gosub6000
1000gosub2000
1020gosub4000
1040gosub5000
1050ifpv<=0thengosub1100:goto130
1055ifmu=1thenputsprite0,(0,212),,p1:ma=ma+1:ms=ms+1:gosub13100:mu=0:ifma>5thengoto14100
1060'gosub6100
1090goto1000
2000onstick(0)gosub2200,2400,2600,2800,3000,3200,3400,3600
2190return
2200ifpa<>1thenpo=py:pa=1
2290return
2400ifpa<>1thenpo=py:pa=1
2410px=px+pv
2430swapp1,p2
2490return
2600px=px+pv
2610pd=3
2630swapp1,p2
2690return
2800'nada'
2890return
3000'nada'
3090return
3200'nada'
3290return
3400px=px-pv
3410pd=7
3440swapp3,p4
3490return
3600ifpa<>1thenpo=py:pa=1
3610px=px-pv
3630swapp3,p4
3690return
4000'Player'
    4010 if mc>=200-32 then screen 1:print "FINAL": return
4015ifpx>255thenputsprite0,(0,212),,p1:gosub13600:py=18*8:px=8:gosub12700:ms=ms+1:gosub13800:gosub6000
4020ifpx<0thenpx=0
4030ifpy>180thengosub10400
4035tx=px/8+mc:ty=py/8:ifpx<=0thentx=0:ifpy<=0thenty=0
4040t0=m(tx,ty+1)
4045ift0<26thenm(tx,ty+1)=tw:line(px-8,py+8)-(px+8,py+16),14,bf:wc=wc-1:gosub6000:re=6:gosub7000
4050ift0=tdthengosub10400:beep
4055'_turboon(m(),te,t0,t3,t5,t7,tx,ty,mu)
4058ift0=tethenmu=1
4060t3=m(tx+1,ty+1)
4070t5=m(tx,ty+2)
4080t7=m(tx,ty+1)
4085'_turbooff
4090ift3>=tfandpa=0thenpx=px-pvelseift7>=tfandpa=0thenpx=px+pv
4110ifpa=1andt5>=tfandpl<0thenpa=0:pl=-pl
4120ifpa=1thenpy=py-pl
4130ifpa=1andpy<po-16thenpl=-pl
4140ifpa=1andpy>pothenpy=po:pl=-pl:pa=0
4150ifpa=0andt5<tfthenpy=py+pl
4290return
5000ifbo=1thengosub12850
5010ifpd=3orpd=1orpd=2thenputsprite0,(px,py),,p1
5020ifpd=7thenputsprite0,(px,py),,p3
5030ifbo<>0thenifpx<ba+16andpx+pw>baandpy<bb+16andpy+ph>bbthengosub10400
5100gosub11700
5200ifen<=0thenreturn
5210fori=1toen
5220ex(i)=ex(i)+ev(i)
5230ifex(i)mod5=0thenev(i)=-ev(i)
5240ifes(i)>=7ores(i)<=9thenifev(i)>0thenes(i)=7elsees(i)=9
5250ifes(i)>=11ores(i)<=13thenifev(i)>0thenes(i)=11elsees(i)=13
5260putspriteep(i),(ex(i),ey(i)),,es(i)
5270ifpx<ex(i)+16andpx+pw>ex(i)andpy<ey(i)+16andpy+ph>ey(i)thengosub10400
5280forw=1todn
5290ifdx(w)<ex(i)+16anddx(w)+dw>ex(i)anddy(w)<ey(i)+16anddy(w)+dh>ey(i)thened=i:gosub12600:dd=w:gosub11600:re=7:gosub7000
5300nextw
5310nexti
5990return
6000line(0,184)-(256,212),1,bf
    6010 preset (10,186):print #1,"Capturas que faltan: "wc
    6020 preset (10,194):print #1,"Vidas: "pe" Level: "mu"-"ms
    6030 if bo=1 then preset (10,202):print #1,"Energia boss: "be
6090return
6100preset(10,30):print#1,"en"en"bo"bo
6190return
6500al=0:tf=0:te=0:tw=0
6510time=0
6550t1=0:t3=0:t5=0:t7=0
6990return
7000a=usr2(0)
7010'ifre=1thenPLAY"O5L8V4M8000AADFG2AAAAr60GEFDCDGR8A2A2A8","o1v4cr8o2cr8o1v6cr8o2v4cr8o1cr8o2v6cr8"
7050ifre=5thenplay"l10o4a"
7051ifre=6thenplay"t110o4d"
7052ifre=7thenplay"l10o4ff"
7060ifre=16thenplay"t250o5v12dv9e"
7070ifre=17thenplay"O5L8V4M8000AADFG2AAAA"
7080ifre=18thenPLAY"S1M2000T150O7C32"
7090ifre=19thenPLAY"o2l64t255v10m6500c"
7100ifre=20thensound6,5:sound8,16:sound12,6:sound13,9
7190return
10200px=16:py=13*8:pw=8:ph=16:pv=4:pl=8:pj=0:pa=0:pd=3:pe=5
10210'j(0)=-8:j(1)=-8:j(2)=-8:j(3)=0:j(4)=8:j(5)=8:j(6)=8
10230p1=0:p2=1:p3=2:p4=3
10240pp=0:ps=0
10290return
10400ba=0:bb=240:putsprite9,(ba,bb),,18
10405py=18*8:px=8:putsprite0,(px,py),,p1
10410pe=pe-1
10415pa=0:ifpl<=0thenpl=-pl
10420gosub6000
10430re=6:gosub7000
10490return
10500re=5:gosub7000
10510gosub11500
10590return
11000dm=4:dn=0:dd=0:ds=6:dc=6:dp=0:dw=8:dh=2
11010DIMdx(dm),dy(dm),di(dm),dv(dm),dp(dm)
11060return
11500ifdn>=dmthenreturnelsedn=dn+1
11510dx(dn)=px+8:dy(dn)=py+8
11520di(dn)=pd
11530dv(dn)=8
11540ds(dn)=ds
11545dp(dn)=dn+1
11580return
11600putspritedp(dd),(0,212),dc,ds(dd)
11610dx(dd)=dx(dn):dy(dd)=dy(dn)
11650dn=dn-1
11690return
11700ifdn<=0thenreturn
11710fori=1todn
11720ifdi(i)=1ordi(i)=2ordi(i)=3thendx(i)=dx(i)+dv(i)elsedx(i)=dx(i)-dv(i)
11730putspritedp(i),(dx(i),dy(i)),dc,ds(i)
11740ifdx(i)<0ordx(i)>256-16thendd=i:gosub11600
11742ifbo=1thenifdx(i)<bx+bwanddx(i)+dw>bxanddy(i)<by+bhanddy(i)+dh>bythenbe=be-10:dd=i:gosub6000:gosub11600:beep
11750nexti
11790return
12000em=3:en=0:es=7
12010DIMex(em),ey(em),ev(em),el(em),es(em),ep(em),ec(em),ee(em)
12030return
12500ifen>=emthenreturnelseen=en+1
12510ex(en)=0:ey(en)=0
12530ev(en)=8:el(en)=8
12540es(en)=es:ep(en)=9+en
12560ee(en)=100
12590return
12600ifen<=0thenreturn
12600ex(ed)=ex(en):ey(ed)=ey(en):ev(ed)=ev(en):el(ed)=el(en):es(ed)=es(en):ep(ed)=ep(en):ec(ed)=ec(en):ee(ed)=ee(en)
12610putspriteep(ed),(0,212),,es(ed)
12650en=en-1
12660return
12700en=0
12790return
12800bo=0:bx=0:bw=24:bh=16:bz=0:bi=0:by=0:be=100:bv=8:bd=3
12810ba=0:bb=0
12810return
12850bi=bx:bz=by:by=by-bv
12855ifbn=0thenline(bx,bz)-(bx+bw,bz+bh),14,bf:copy(24,64)-(48,80),1to(bx,by),0,tpset:ifby<100orby>154thenbv=-bv
12890ifbe<=0thenbo=0:line(bx,by)-(bx+bw,bz+bh),14,bf:m(195,21)=te:copy(te*8,0*8)-((te*8)+8,(0*8)+8),1to(30*8,21*8),0,tpset:re=2:gosub7000:putsprite9,(0,212),,18
12891ifbo=1andtime/60>8thentime=0:ba=bx:bb=by
12892ifbo=1thenba=ba-8:ifba<1thenputsprite9,(0,212),,18:ba=0elseputsprite9,(ba,bb),,18
12899return
    13000 'print #1, "Pintando mapa"
13010dimm(200,26):mc=0:ma=0:ms=0:mu=0
13020return
13100'estoalmacenaráelarrayapartirdelaposiciónhc901delaVRAM'
    13110 if ma=0 then cls: preset(0,100):print #1,"Pintando Mundo 1, espere...":bload"world0.bin",r:gosub 20000
    13115 if ma=1 then cls: preset(0,100):print #1,"Pintando Mundo 2, espere...":bload"world1.bin",r:mc=0:gosub 21000:gosub 6000
13120md=&hc901
13130forf=0to23-1
13140forc=0to200-1
13150tn=peek(md):md=md+1
13160m(c,f)=tn
13170nextc
13180nextf
13185gosub13300
13190return
13300_turboon(m())
13310forf=0to23-1
13360forc=0to32-1
13370tn=m(c,f)
13380iftn>=0andtn<32thencopy(tn*8,0*8)-((tn*8)+8,(0*8)+8),1to(c*8,f*8),0,tpset
13390iftn>=32andtn<64thencopy((tn-32)*8,1*8)-(((tn-32)*8)+8,(1*8)+8),1to(c*8,f*8),0,tpset
13400iftn>=64andtn<96thencopy((tn-64)*8,2*8)-(((tn-64)*8)+8,(2*8)+8),1to(c*8,f*8),0,tpset
13410iftn>=96andtn<128thencopy((tn-96)*8,3*8)-(((tn-96)*8)+8,(3*8)+8),1to(c*8,f*8),0,tpset
13420iftn>=128andtn<160thencopy((tn-128)*8,4*8)-(((tn-128)*8)+8,(4*8)+8),1to(c*8,f*8),0,tpset
13430iftn>=160andtn<192thencopy((tn-160)*8,5*8)-(((tn-160)*8)+8,(5*8)+8),1to(c*8,f*8),0,tpset
13440iftn>=192andtn<224thencopy((tn-192)*8,6*8)-(((tn-192)*8)+8,(6*8)+8),1to(c*8,f*8),0,tpset
13450iftn>=224andtn<256thencopy((tn-224)*8,7*8)-(((tn-224)*8)+8,(7*8)+8),1to(c*8,f*8),0,tpset
13510nextc
13520nextf
13540_turbooff
13570return
13600ifmc=200-32thenreturn
13602_turboon(m(),mc)
13603fori=0+msto32+ms
13605mc=mc+1
13610copy(8,0)-(256,184),0to(0,0),0,pset
13620forf=3to23-1
13630tn=m(31+mc,f)
13640iftn>=0andtn<32thencopy(tn*8,0*8)-((tn*8)+8,(0*8)+8),1to(31*8,f*8),0
13650iftn>=32andtn<64thencopy((tn-32)*8,1*8)-(((tn-32)*8)+8,(1*8)+8),1to(31*8,f*8),0
13660iftn>=64andtn<96thencopy((tn-64)*8,2*8)-(((tn-64)*8)+8,(2*8)+8),1to(31*8,f*8),0
13670iftn>=96andtn<128thencopy((tn-96)*8,3*8)-(((tn-96)*8)+8,(3*8)+8),1to(31*8,f*8),0
13680iftn>=128andtn<160thencopy((tn-128)*8,4*8)-(((tn-128)*8)+8,(4*8)+8),1to(31*8,f*8),0
13690iftn>=160andtn<192thencopy((tn-160)*8,5*8)-(((tn-160)*8)+8,(5*8)+8),1to(31*8,f*8),0
13700iftn>=192andtn<224thencopy((tn-192)*8,6*8)-(((tn-192)*8)+8,(6*8)+8),1to(31*8,f*8),0
13710iftn>=224andtn<256thencopy((tn-224)*8,7*8)-(((tn-224)*8)+8,(7*8)+8),1to(31*8,f*8),0
13720nextf
13730nexti
13735_turbooff
13740return
13800ifms=0thengosub20100
13801ifms=1thengosub20200
13810ifms=2thengosub20300
13820ifms=3thengosub20400
13830ifms=4thengosub20500
13840ifms=5thengosub20600
13850ifms=6thengosub21100
13860ifms=7thengosub21200
13990return
    14000 cls:preset (10,30):  print #1,"@@@@  @  @@@@  @ @@@@@ @  @   @"
    14010 preset (10,40):      print #1,"@    @ @ @@@@  @   @  @ @ @ @ @"
    14020 preset (10,50):      print #1,"@@@@@   @@     @   @ @   @@  @@"
    14030 preset (10,70):      print #1,"10540,capita Kik, debes ir a recoger las muestras fabricadas en otros entornos planetarios."
    14040 preset (10,110):     print #1,"Pero ten cuidado los esbirros de worst que te obstaculizan."
    14050 preset (10,160): print #1, "Cursores para mover, pulsa una tecla para continuar"
    14060 preset (10,180): print #1, "libre: "fre(0)
14070ifinkey$=""thengoto14070
14090goto100
14100cls:preset(10,70):print#1,"Felicidades"ma
    14110 preset (10,80):      print #1,"Has completado la mision"
    14120 preset (10,90):      print #1,"Lgica:Kikemadrigal"
    14130 preset (10,100):      print #1,"gráficos:Kikemadrigal"
14140ifinkey$=""thengoto14040
14150gosub1100
14190:goto800
20000tf=160:te=26:tw=80:td=42
20010wc=12
20090return
20100gosub12500:ex(en)=26*8:ey(en)=20*8
20190return
20200gosub12500:ex(en)=(17*8):ey(en)=17*8:es(en)=11
20290return
20300gosub12500:ex(en)=20*8:ey(en)=20*8:es(en)=11
20390return
20400gosub12500:ex(en)=16*8:ey(en)=10*8:es(en)=11
20490return
20500gosub12500:ex(en)=26*8:ey(en)=20*8
20590return
20600gosub12800:bo=1:bn=0:be=100:bx=150:by=120:gosub6000
20690return
21000tf=170:te=26:tw=80:td=42
21010px=8:py=19*8
21020wc=6
21090return
21100gosub12500:ex(en)=(17*8):ey(en)=17*8:es(en)=11
21190return
21200gosub12500:ex(en)=(17*8):ey(en)=5*8:es(en)=11
21290return
